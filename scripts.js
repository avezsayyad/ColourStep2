var inv_itypes=null;function autocomplete(e,t,n){var a;function i(e){if(!e)return!1;!function(e){for(var t=0;t<e.length;t++)e[t].classList.remove("autocomplete-active")}(e),a>=e.length&&(a=0),a<0&&(a=e.length-1),e[a].classList.add("autocomplete-active")}function r(t){for(var n=document.getElementsByClassName("autocomplete-items"),a=0;a<n.length;a++)t!=n[a]&&t!=e&&n[a].parentNode.removeChild(n[a])}e.addEventListener("input",(function(i){var o,s,u,l=this.value;if(r(),!l)return!1;a=-1,(o=document.createElement("DIV")).setAttribute("id",this.id+"autocomplete-list"),o.setAttribute("class","autocomplete-items"),this.parentNode.appendChild(o),t(l,(t=>{for(u=0;u<t.length;u++){s=document.createElement("DIV");for(let e of Object.keys(t[u]))s.setAttribute("data-"+e,t[u][e]);l=l.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var a=new RegExp("("+l.split(" ").join("|")+")","gi");s.innerHTML=t[u].value.replace(a,"<b>$1</b>"),s.addEventListener("click",(function(t){e.value=this.getAttribute("data-value");let a={};for(let e=0;e<this.attributes.length;e++){var i=this.attributes[e].name,o=this.attributes[e].value;i.startsWith("data-")&&(a[i.substring(5,i.length)]=o)}n(a),r()})),o.appendChild(s)}}))})),e.addEventListener("keydown",(function(e){!function(){if(inv_itypes)return;var e=new XMLHttpRequest;e.timeout=3e4,e.open("GET","/aalam/ecomm/setting/item_types",!0),e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){let t=JSON.parse(e.response);inv_itypes=t.invalids||[]}},e.send(null)}();var t=document.getElementById(this.id+"autocomplete-list");t&&(t=t.getElementsByTagName("div")),40==e.keyCode?(a++,i(t)):38==e.keyCode?(a--,i(t)):13==e.keyCode&&(e.preventDefault(),a>-1&&t&&t[a].click())}))}function stringifyParams(e){var t="";for(var n in e)""!=t&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]);return t}function queryProducts(e,t){if(!inv_itypes)return;let n={search:e,suggest:!0};inv_itypes&&inv_itypes.length&&(n.type_id_ne=inv_itypes.join(","));var a=new XMLHttpRequest;a.timeout=3e4,a.open("GET","/aalam/stock/items?"+stringifyParams(n),!0),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){let e=[],n=JSON.parse(a.response);for(let t=0;t<n.found.length;t++)e.push({value:n.found[t]});t(e)}},a.send(null)}function productSelected(e){window.location.href=`/store/?search=${e.value}`}function setupNavWrapper(e){window.innerWidth<960?e.style.backgroundColor="rgba(134,223,200,0.32)":e.style.backgroundColor="transparent"}window.addEventListener("load",(function(){let e=document.querySelectorAll("input.search-input");for(let t of e)autocomplete(t,((e,t)=>{queryProducts(e,t)}),(e=>{productSelected(e)}));let t=document.querySelector(".mob-dt-navwrapper");setupNavWrapper(t),window.addEventListener("resize",(()=>{setupNavWrapper(t)}))}));